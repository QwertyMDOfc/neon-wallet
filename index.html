
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neon Wallet - Digital E-Wallet</title>
    <style>
        :root {
            --primary: #6e00ff;
            --secondary: #ff00cc;
            --dark: #0f0f1a;
            --light: #f5f5ff;
            --success: #00ff88;
            --danger: #ff3860;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: var(--dark);
            color: var(--light);
            min-height: 100vh;
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(110, 0, 255, 0.1) 0%, transparent 20%),
                radial-gradient(circle at 90% 80%, rgba(255, 0, 204, 0.1) 0%, transparent 20%);
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Header Styles */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
            margin-bottom: 2rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .logo {
            font-size: 1.8rem;
            font-weight: 700;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            position: relative;
        }

        .logo::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            border-radius: 3px;
            transform: scaleX(0);
            transform-origin: right;
            transition: transform 0.3s ease;
        }

        .logo:hover::after {
            transform: scaleX(1);
            transform-origin: left;
        }

        .auth-buttons button {
            padding: 0.5rem 1.5rem;
            border-radius: 50px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-left: 1rem;
        }

        .login-btn {
            background: transparent;
            color: var(--light);
            border: 2px solid var(--primary);
        }

        .login-btn:hover {
            background: var(--primary);
            box-shadow: 0 0 15px rgba(110, 0, 255, 0.5);
        }

        .register-btn {
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            color: white;
        }

        .register-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(110, 0, 255, 0.4);
        }

        /* Main Content Styles */
        .main-content {
            display: none;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .auth-forms {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 70vh;
        }

        .form-container {
            background: rgba(15, 15, 26, 0.8);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 2rem;
            width: 100%;
            max-width: 500px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transform: translateY(20px);
            opacity: 0;
            animation: fadeInUp 0.5s forwards 0.3s;
        }

        @keyframes fadeInUp {
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .form-title {
            text-align: center;
            margin-bottom: 2rem;
            font-size: 1.8rem;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .form-group {
            margin-bottom: 1.5rem;
            position: relative;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .form-group input {
            width: 100%;
            padding: 0.8rem 1rem;
            border-radius: 8px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            background: rgba(255, 255, 255, 0.05);
            color: var(--light);
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .form-group input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(110, 0, 255, 0.3);
        }

        .form-group input::placeholder {
            color: rgba(255, 255, 255, 0.3);
        }

        .submit-btn {
            width: 100%;
            padding: 1rem;
            border-radius: 8px;
            border: none;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            color: white;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 1rem;
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(110, 0, 255, 0.4);
        }

        .form-footer {
            text-align: center;
            margin-top: 1.5rem;
            color: rgba(255, 255, 255, 0.6);
        }

        .form-footer a {
            color: var(--primary);
            text-decoration: none;
            font-weight: 500;
        }

        .form-footer a:hover {
            text-decoration: underline;
        }

        /* Dashboard Styles */
        .dashboard {
            display: none;
        }

        .balance-card {
            background: linear-gradient(135deg, rgba(110, 0, 255, 0.2), rgba(255, 0, 204, 0.2));
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 2rem;
            position: relative;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .balance-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 0%, transparent 70%);
            transform: rotate(30deg);
            animation: shine 3s infinite;
        }

        @keyframes shine {
            0% {
                transform: rotate(30deg) translate(-30%, -30%);
            }
            100% {
                transform: rotate(30deg) translate(30%, 30%);
            }
        }

        .balance-title {
            font-size: 1rem;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 0.5rem;
        }

        .balance-amount {
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 1rem;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .balance-actions {
            display: flex;
            gap: 1rem;
        }

        .action-btn {
            flex: 1;
            padding: 0.8rem;
            border-radius: 8px;
            border: none;
            background: rgba(255, 255, 255, 0.1);
            color: var(--light);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .action-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .action-btn.primary {
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            color: white;
        }

        .action-btn.primary:hover {
            box-shadow: 0 5px 15px rgba(110, 0, 255, 0.4);
        }

        /* Transactions Section */
        .transactions-section {
            margin-top: 2rem;
        }

        .section-title {
            font-size: 1.5rem;
            margin-bottom: 1.5rem;
            position: relative;
            display: inline-block;
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 50%;
            height: 3px;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            border-radius: 3px;
        }

        .transactions-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .transaction-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
            border-left: 4px solid transparent;
        }

        .transaction-card:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(5px);
        }

        .transaction-card.income {
            border-left-color: var(--success);
        }

        .transaction-card.outcome {
            border-left-color: var(--danger);
        }

        .transaction-info {
            flex: 1;
        }

        .transaction-title {
            font-weight: 600;
            margin-bottom: 0.3rem;
        }

        .transaction-date {
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.5);
        }

        .transaction-amount {
            font-weight: 700;
        }

        .transaction-amount.income {
            color: var(--success);
        }

        .transaction-amount.outcome {
            color: var(--danger);
        }

        /* Transfer Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .modal.active {
            display: flex;
            opacity: 1;
        }

        .modal-content {
            background: var(--dark);
            border-radius: 20px;
            padding: 2rem;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transform: scale(0.9);
            opacity: 0;
            transition: all 0.3s ease;
        }

        .modal.active .modal-content {
            transform: scale(1);
            opacity: 1;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .modal-title {
            font-size: 1.5rem;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .close-modal {
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.5);
            font-size: 1.5rem;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .close-modal:hover {
            color: var(--danger);
        }

        /* Loading Animation */
        .loading {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--dark);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            flex-direction: column;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            border-top-color: var(--primary);
            animation: spin 1s linear infinite;
            margin-bottom: 1rem;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        .loading-text {
            color: var(--light);
            font-size: 1.2rem;
            margin-top: 1rem;
            opacity: 0.7;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }

            .balance-actions {
                flex-direction: column;
            }

            .action-btn {
                width: 100%;
            }
        }

        /* Notification */
        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(15, 15, 26, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 10px;
            padding: 1rem;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            border-left: 4px solid var(--success);
            transform: translateX(150%);
            transition: transform 0.3s ease;
            z-index: 1001;
            max-width: 300px;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.error {
            border-left-color: var(--danger);
        }

        .notification-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .notification-message {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.7);
        }

        /* Tabs */
        .tabs {
            display: flex;
            margin-bottom: 1.5rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .tab {
            padding: 0.8rem 1.5rem;
            cursor: pointer;
            position: relative;
            opacity: 0.7;
            transition: all 0.3s ease;
        }

        .tab.active {
            opacity: 1;
        }

        .tab.active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            border-radius: 3px 3px 0 0;
        }

        /* Logout Button */
        .logout-btn {
            background: rgba(255, 56, 96, 0.1);
            color: var(--danger);
            border: 1px solid var(--danger);
            padding: 0.5rem 1rem;
            border-radius: 50px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .logout-btn:hover {
            background: rgba(255, 56, 96, 0.2);
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div class="loading">
        <div class="loading-spinner"></div>
        <div class="loading-text">Loading Neon Wallet...</div>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification">
        <div class="notification-title" id="notification-title">Success</div>
        <div class="notification-message" id="notification-message">Operation completed successfully</div>
    </div>

    <div class="container">
        <header>
            <div class="logo">Neon Wallet</div>
            <div class="auth-buttons" id="auth-buttons">
                <button class="login-btn" id="show-login">Login</button>
                <button class="register-btn" id="show-register">Register</button>
            </div>
            <button class="logout-btn" id="logout-btn" style="display: none;">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M10 12.5a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 .5.5v2a.5.5 0 0 0 1 0v-2A1.5 1.5 0 0 0 9.5 2h-8A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h8a1.5 1.5 0 0 0 1.5-1.5v-2a.5.5 0 0 0-1 0v2z"/>
                    <path fill-rule="evenodd" d="M15.854 8.354a.5.5 0 0 0 0-.708l-3-3a.5.5 0 0 0-.708.708L14.293 7.5H5.5a.5.5 0 0 0 0 1h8.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3z"/>
                </svg>
                Logout
            </button>
        </header>

        <!-- Authentication Forms -->
        <div class="auth-forms" id="auth-forms">
            <!-- Login Form -->
            <div class="form-container" id="login-form">
                <h2 class="form-title">Welcome Back</h2>
                <form id="login-form-data">
                    <div class="form-group">
                        <label for="login-email">Email</label>
                        <input type="email" id="login-email" placeholder="Enter your email" required>
                    </div>
                    <div class="form-group">
                        <label for="login-password">Password</label>
                        <input type="password" id="login-password" placeholder="Enter your password" required>
                    </div>
                    <button type="submit" class="submit-btn">Login</button>
                </form>
                <div class="form-footer">
                    Don't have an account? <a href="#" id="switch-to-register">Register</a>
                </div>
            </div>

            <!-- Register Form -->
            <div class="form-container" id="register-form" style="display: none;">
                <h2 class="form-title">Create Account</h2>
                <form id="register-form-data">
                    <div class="form-group">
                        <label for="register-username">Username</label>
                        <input type="text" id="register-username" placeholder="Choose a username" required>
                    </div>
                    <div class="form-group">
                        <label for="register-email">Email</label>
                        <input type="email" id="register-email" placeholder="Enter your email" required>
                    </div>
                    <div class="form-group">
                        <label for="register-password">Password</label>
                        <input type="password" id="register-password" placeholder="Create a password" required>
                    </div>
                    <div class="form-group">
                        <label for="register-confirm-password">Confirm Password</label>
                        <input type="password" id="register-confirm-password" placeholder="Confirm your password" required>
                    </div>
                    <button type="submit" class="submit-btn">Register</button>
                </form>
                <div class="form-footer">
                    Already have an account? <a href="#" id="switch-to-login">Login</a>
                </div>
            </div>
        </div>

        <!-- Main Dashboard -->
        <div class="main-content" id="main-content">
            <div class="dashboard" id="dashboard">
                <!-- Balance Card -->
                <div class="balance-card">
                    <h3 class="balance-title">Your Balance</h3>
                    <h1 class="balance-amount" id="user-balance">$0.00</h1>
                    <div class="balance-actions">
                        <button class="action-btn primary" id="transfer-btn">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                <path fill-rule="evenodd" d="M1 11.5a.5.5 0 0 0 .5.5h11.793l-3.147 3.146a.5.5 0 0 0 .708.708l4-4a.5.5 0 0 0 0-.708l-4-4a.5.5 0 0 0-.708.708L13.293 11H1.5a.5.5 0 0 0-.5.5zm14-7a.5.5 0 0 1-.5.5H2.707l3.147 3.146a.5.5 0 1 1-.708.708l-4-4a.5.5 0 0 1 0-.708l4-4a.5.5 0 1 1 .708.708L2.707 4H14.5a.5.5 0 0 1 .5.5z"/>
                            </svg>
                            Transfer
                        </button>
                        <button class="action-btn" id="topup-btn">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                <path d="M12.136.326A1.5 1.5 0 0 1 14 1.78V3h.5A1.5 1.5 0 0 1 16 4.5v9a1.5 1.5 0 0 1-1.5 1.5h-13A1.5 1.5 0 0 1 0 13.5v-9a1.5 1.5 0 0 1 1.432-1.499L12.136.326zM5.562 3H13V1.78a.5.5 0 0 0-.621-.484L5.562 3zM1.5 4a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h13a.5.5 0 0 0 .5-.5v-9a.5.5 0 0 0-.5-.5h-13z"/>
                                <path d="M8 5.5a.5.5 0 0 1 .5.5v1.5H10a.5.5 0 0 1 0 1H8.5V10a.5.5 0 0 1-1 0V8.5H6a.5.5 0 0 1 0-1h1.5V6a.5.5 0 0 1 .5-.5z"/>
                            </svg>
                            Top Up
                        </button>
                    </div>
                </div>

                <!-- Transactions Section -->
                <div class="transactions-section">
                    <h3 class="section-title">Recent Transactions</h3>
                    <div class="tabs">
                        <div class="tab active" id="all-tab">All</div>
                        <div class="tab" id="income-tab">Income</div>
                        <div class="tab" id="outcome-tab">Outcome</div>
                    </div>
                    <div class="transactions-list" id="transactions-list">
                        <!-- Transactions will be loaded here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Transfer Modal -->
    <div class="modal" id="transfer-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Transfer Money</h3>
                <button class="close-modal" id="close-transfer-modal">&times;</button>
            </div>
            <form id="transfer-form">
                <div class="form-group">
                    <label for="recipient-email">Recipient Email</label>
                    <input type="email" id="recipient-email" placeholder="Enter recipient's email" required>
                </div>
                <div class="form-group">
                    <label for="transfer-amount">Amount</label>
                    <input type="number" id="transfer-amount" placeholder="Enter amount to transfer" required>
                </div>
                <div class="form-group">
                    <label for="transfer-note">Note (Optional)</label>
                    <input type="text" id="transfer-note" placeholder="Add a note">
                </div>
                <button type="submit" class="submit-btn">Transfer Now</button>
            </form>
        </div>
    </div>

    <!-- Top Up Modal -->
    <div class="modal" id="topup-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Top Up Balance</h3>
                <button class="close-modal" id="close-topup-modal">&times;</button>
            </div>
            <form id="topup-form">
                <div class="form-group">
                    <label for="topup-amount">Amount</label>
                    <input type="number" id="topup-amount" placeholder="Enter amount to top up" required>
                </div>
                <div class="form-group">
                    <label for="topup-method">Payment Method</label>
                    <select id="topup-method" class="form-group input" required>
                        <option value="">Select payment method</option>
                        <option value="credit_card">Credit Card</option>
                        <option value="bank_transfer">Bank Transfer</option>
                        <option value="ewallet">Other E-Wallet</option>
                    </select>
                </div>
                <button type="submit" class="submit-btn">Top Up Now</button>
            </form>
        </div>
    </div>

    <script>
        // Simulate database
        let db = {
            users: [],
            transfers: [],
            next_user_id: 1,
            next_transaction_id: 1,
            next_transfer_id: 1
        };

        // Current user
        let currentUser = null;

        // DOM Elements
        const loadingScreen = document.querySelector('.loading');
        const notification = document.getElementById('notification');
        const notificationTitle = document.getElementById('notification-title');
        const notificationMessage = document.getElementById('notification-message');
        const authButtons = document.getElementById('auth-buttons');
        const logoutBtn = document.getElementById('logout-btn');
        const showLoginBtn = document.getElementById('show-login');
        const showRegisterBtn = document.getElementById('show-register');
        const switchToLogin = document.getElementById('switch-to-login');
        const switchToRegister = document.getElementById('switch-to-register');
        const loginForm = document.getElementById('login-form');
        const registerForm = document.getElementById('register-form');
        const loginFormData = document.getElementById('login-form-data');
        const registerFormData = document.getElementById('register-form-data');
        const authForms = document.getElementById('auth-forms');
        const mainContent = document.getElementById('main-content');
        const dashboard = document.getElementById('dashboard');
        const userBalance = document.getElementById('user-balance');
        const transferBtn = document.getElementById('transfer-btn');
        const topupBtn = document.getElementById('topup-btn');
        const transactionsList = document.getElementById('transactions-list');
        const allTab = document.getElementById('all-tab');
        const incomeTab = document.getElementById('income-tab');
        const outcomeTab = document.getElementById('outcome-tab');
        const transferModal = document.getElementById('transfer-modal');
        const closeTransferModal = document.getElementById('close-transfer-modal');
        const transferForm = document.getElementById('transfer-form');
        const topupModal = document.getElementById('topup-modal');
        const closeTopupModal = document.getElementById('close-topup-modal');
        const topupForm = document.getElementById('topup-form');

        // Initialize the app
        function init() {
            // Try to load database from localStorage
            const savedDB = localStorage.getItem('wallet_db');
            if (savedDB) {
                db = JSON.parse(savedDB);
            }

            // Check if user is already logged in
            const loggedInUser = localStorage.getItem('current_user');
            if (loggedInUser) {
                currentUser = JSON.parse(loggedInUser);
                showDashboard();
            }

            // Hide loading screen after 1.5 seconds
            setTimeout(() => {
                loadingScreen.style.display = 'none';
                if (!currentUser) {
                    authForms.style.display = 'flex';
                    setTimeout(() => {
                        authForms.style.opacity = '1';
                    }, 100);
                }
            }, 1500);

            // Setup event listeners
            setupEventListeners();
        }

        // Setup all event listeners
        function setupEventListeners() {
            // Auth buttons
            showLoginBtn.addEventListener('click', () => {
                loginForm.style.display = 'block';
                registerForm.style.display = 'none';
            });

            showRegisterBtn.addEventListener('click', () => {
                registerForm.style.display = 'block';
                loginForm.style.display = 'none';
            });

            switchToLogin.addEventListener('click', (e) => {
                e.preventDefault();
                loginForm.style.display = 'block';
                registerForm.style.display = 'none';
            });

            switchToRegister.addEventListener('click', (e) => {
                e.preventDefault();
                registerForm.style.display = 'block';
                loginForm.style.display = 'none';
            });

            // Login form
            loginFormData.addEventListener('submit', (e) => {
                e.preventDefault();
                const email = document.getElementById('login-email').value;
                const password = document.getElementById('login-password').value;
                loginUser(email, password);
            });

            // Register form
            registerFormData.addEventListener('submit', (e) => {
                e.preventDefault();
                const username = document.getElementById('register-username').value;
                const email = document.getElementById('register-email').value;
                const password = document.getElementById('register-password').value;
                const confirmPassword = document.getElementById('register-confirm-password').value;

                if (password !== confirmPassword) {
                    showNotification('Error', 'Passwords do not match', 'error');
                    return;
                }

                registerUser(username, email, password);
            });

            // Logout button
            logoutBtn.addEventListener('click', logoutUser);

            // Transfer button
            transferBtn.addEventListener('click', () => {
                transferModal.classList.add('active');
            });

            // Top Up button
            topupBtn.addEventListener('click', () => {
                topupModal.classList.add('active');
            });

            // Close modals
            closeTransferModal.addEventListener('click', () => {
                transferModal.classList.remove('active');
            });

            closeTopupModal.addEventListener('click', () => {
                topupModal.classList.remove('active');
            });

            // Transfer form
            transferForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const recipientEmail = document.getElementById('recipient-email').value;
                const amount = parseFloat(document.getElementById('transfer-amount').value);
                const note = document.getElementById('transfer-note').value || 'Transfer';

                transferMoney(currentUser.id, recipientEmail, amount, note);
            });

            // Top Up form
            topupForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const amount = parseFloat(document.getElementById('topup-amount').value);
                const method = document.getElementById('topup-method').value;

                topUpBalance(currentUser.id, amount, method);
            });

            // Tabs
            allTab.addEventListener('click', () => {
                setActiveTab('all');
                loadTransactions('all');
            });

            incomeTab.addEventListener('click', () => {
                setActiveTab('income');
                loadTransactions('income');
            });

            outcomeTab.addEventListener('click', () => {
                setActiveTab('outcome');
                loadTransactions('outcome');
            });

            // Close modal when clicking outside
            window.addEventListener('click', (e) => {
                if (e.target === transferModal) {
                    transferModal.classList.remove('active');
                }
                if (e.target === topupModal) {
                    topupModal.classList.remove('active');
                }
            });
        }

        // Show notification
        function showNotification(title, message, type = 'success') {
            notificationTitle.textContent = title;
            notificationMessage.textContent = message;
            
            if (type === 'error') {
                notification.classList.add('error');
            } else {
                notification.classList.remove('error');
            }
            
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // Register a new user
        function registerUser(username, email, password) {
            // Check if user already exists
            const userExists = db.users.some(user => user.email === email || user.username === username);
            if (userExists) {
                showNotification('Error', 'User already exists', 'error');
                return;
            }

            // Create new user
            const newUser = {
                id: db.next_user_id++,
                username,
                email,
                password: btoa(password), // Note: In a real app, use proper hashing like bcrypt
                balance: 0,
                transactions: []
            };

            db.users.push(newUser);
            saveDB();

            showNotification('Success', 'Account created successfully');
            loginForm.style.display = 'block';
            registerForm.style.display = 'none';
            
            // Clear form
            registerFormData.reset();
        }

        // Login user
        function loginUser(email, password) {
            const user = db.users.find(user if (!user) {
                showNotification('Error', 'User not found', 'error');
                return;
            }

            // Check password (in a real app, use proper password verification)
            if (atob(user.password) !== password) {
                showNotification('Error', 'Invalid password', 'error');
                return;
            }

            // Login successful
            currentUser = {
                id: user.id,
                username: user.username,
                email: user.email,
                balance: user.balance
            };

            // Save to localStorage
            localStorage.setItem('current_user', JSON.stringify(currentUser));

            // Show dashboard
            showDashboard();

            // Clear form
            loginFormData.reset();

            showNotification('Welcome back', `Hello ${user.username}!`, 'success');
        }

        // Logout user
        function logoutUser() {
            currentUser = null;
            localStorage.removeItem('current_user');
            
            // Hide dashboard and show auth forms
            mainContent.style.opacity = '0';
            setTimeout(() => {
                mainContent.style.display = 'none';
                authForms.style.display = 'flex';
                setTimeout(() => {
                    authForms.style.opacity = '1';
                }, 100);
            }, 300);
            
            // Reset forms
            loginForm.style.display = 'block';
            registerForm.style.display = 'none';
            
            showNotification('Logged out', 'You have been successfully logged out');
        }

        // Show dashboard
        function showDashboard() {
            authForms.style.opacity = '0';
            setTimeout(() => {
                authForms.style.display = 'none';
                mainContent.style.display = 'block';
                setTimeout(() => {
                    mainContent.style.opacity = '1';
                }, 100);
            }, 300);

            // Update UI
            authButtons.style.display = 'none';
            logoutBtn.style.display = 'block';
            
            // Load user data
            loadUserData();
        }

        // Load user data
        function loadUserData() {
            const user = db.users.find(u => u.id === currentUser.id);
            if (!user) {
                logoutUser();
                return;
            }

            // Update current user data
            currentUser.balance = user.balance;
            localStorage.setItem('current_user', JSON.stringify(currentUser));

            // Update UI
            userBalance.textContent = `$${user.balance.toLocaleString()}`;
            loadTransactions('all');
        }

        // Load transactions
        function loadTransactions(type = 'all') {
            const user = db.users.find(u => u.id === currentUser.id);
            if (!user) return;

            let transactionsToShow = [...user.transactions].reverse(); // Show newest first

            // Filter by type
            if (type === 'income') {
                transactionsToShow = transactionsToShow.filter(t => t.type === 'transfer_in' || t.type === 'topup');
            } else if (type === 'outcome') {
                transactionsToShow = transactionsToShow.filter(t => t.type === 'transfer_out');
            }

            // Clear current transactions
            transactionsList.innerHTML = '';

            // Add transactions to UI
            if (transactionsToShow.length === 0) {
                const emptyMsg = document.createElement('div');
                emptyMsg.textContent = 'No transactions found';
                emptyMsg.style.textAlign = 'center';
                emptyMsg.style.padding = '2rem';
                emptyMsg.style.color = 'rgba(255, 255, 255, 0.5)';
                transactionsList.appendChild(emptyMsg);
                return;
            }

            transactionsToShow.forEach(transaction => {
                const transactionEl = document.createElement('div');
                transactionEl.className = `transaction-card ${transaction.type === 'transfer_in' || transaction.type === 'topup' ? 'income' : 'outcome'}`;

                const transactionInfo = document.createElement('div');
                transactionInfo.className = 'transaction-info';

                const title = document.createElement('div');
                title.className = 'transaction-title';
                title.textContent = transaction.description || 'Transaction';

                const date = document.createElement('div');
                date.className = 'transaction-date';
                date.textContent = new Date(transaction.timestamp).toLocaleString();

                transactionInfo.appendChild(title);
                transactionInfo.appendChild(date);

                const amount = document.createElement('div');
                amount.className = `transaction-amount ${transaction.type === 'transfer_in' || transaction.type === 'topup' ? 'income' : 'outcome'}`;
                amount.textContent = `${transaction.type === 'transfer_in' || transaction.type === 'topup' ? '+' : '-'}$${transaction.amount.toLocaleString()}`;

                transactionEl.appendChild(transactionInfo);
                transactionEl.appendChild(amount);

                transactionsList.appendChild(transactionEl);
            });
        }

        // Set active tab
        function setActiveTab(tab) {
            allTab.classList.remove('active');
            incomeTab.classList.remove('active');
            outcomeTab.classList.remove('active');

            if (tab === 'all') {
                allTab.classList.add('active');
            } else if (tab === 'income') {
                incomeTab.classList.add('active');
            } else if (tab === 'outcome') {
                outcomeTab.classList.add('active');
            }
        }

        // Transfer money
        function transferMoney(fromUserId, recipientEmail, amount, note) {
            if (amount <= 0) {
                showNotification('Error', 'Amount must be greater than 0', 'error');
                return;
            }

            const fromUser = db.users.find(u => u.id === fromUserId);
            if (!fromUser) {
                showNotification('Error', 'Sender not found', 'error');
                return;
            }

            if (fromUser.balance < amount) {
                showNotification('Error', 'Insufficient balance', 'error');
                return;
            }

            const toUser = db.users.find(u => u.email === recipientEmail);
            if (!toUser) {
                showNotification('Error', 'Recipient not found', 'error');
                return;
            }

            if (fromUser.id === toUser.id) {
                showNotification('Error', 'Cannot transfer to yourself', 'error');
                return;
            }

            // Perform transfer
            fromUser.balance -= amount;
            toUser.balance += amount;

            // Record transactions
            const timestamp = new Date().toISOString();
            
            // For sender
            fromUser.transactions.push({
                id: db.next_transaction_id++,
                type: 'transfer_out',
                amount: amount,
                timestamp: timestamp,
                description: `Transfer to ${toUser.username}: ${note}`
            });

            // For recipient
            toUser.transactions.push({
                id: db.next_transaction_id++,
                type: 'transfer_in',
                amount: amount,
                timestamp: timestamp,
                description: `Transfer from ${fromUser.username}: ${note}`
            });

            // Record transfer
            db.transfers.push({
                id: db.next_transfer_id++,
                from_user_id: fromUserId,
                to_user_id: toUser.id,
                amount: amount,
                timestamp: timestamp,
                note: note,
                status: 'completed'
            });

            saveDB();
            loadUserData();
            
            // Close modal and reset form
            transferModal.classList.remove('active');
            transferForm.reset();
            
            showNotification('Success', `Successfully transferred $${amount.toLocaleString()} to ${toUser.username}`);
        }

        // Top up balance
        function topUpBalance(userId, amount, method) {
            if (amount <= 0) {
                showNotification('Error', 'Amount must be greater than 0', 'error');
                return;
            }

            const user = db.users.find(u => u.id === userId);
            if (!user) {
                showNotification('Error', 'User not found', 'error');
                return;
            }

            // In a real app, you would process payment here
            // For demo, we'll just add the amount
            user.balance += amount;

            // Record transaction
            user.transactions.push({
                id: db.next_transaction_id++,
                type: 'topup',
                amount: amount,
                timestamp: new Date().toISOString(),
                description: `Top up via ${method}`
            });

            saveDB();
            loadUserData();
            
            // Close modal and reset form
            topupModal.classList.remove('active');
            topupForm.reset();
            
            showNotification('Success', `Successfully topped up $${amount.toLocaleString()}`);
        }

        // Save database to localStorage
        function saveDB() {
            localStorage.setItem('wallet_db', JSON.stringify(db));
        }

        // Initialize the app when DOM is loaded
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>